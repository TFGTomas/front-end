(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48312:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(2833)}])},2833:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return O}});var a=s(85893),i=s(69077),n=s(67294);class l extends n.Component{logoImg(e){let t=this.props.billeteras;for(let s=0;s<t.length;s++)if(t[s].id===e.id)return t[s].logoImg;return""}renderIsLoanding(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"right-section-header",children:[(0,a.jsx)("h2",{children:"Realizando la conexi\xf3n"}),(0,a.jsx)("div",{className:"close-button-container",children:(0,a.jsx)("span",{className:"material-symbols-outlined close-modal",children:"cancel"})})]}),(0,a.jsx)("div",{className:"wallets-container",children:(0,a.jsxs)("div",{className:"wallet-button wallet-name-loading",children:[(0,a.jsx)("div",{className:"wallet-logo-container",children:(0,a.jsx)("img",{className:"imagen-logo",src:"/pasarela/"+this.logoImg(this.props.connectedObject),alt:""})}),(0,a.jsx)("span",{className:"wallet-name",children:"Conectando..."}),(0,a.jsx)("span",{className:"wallet-name",children:"Seleccione y desbloquee la billetera"})]})})]})}renderIsConnected(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"right-section-header",children:[(0,a.jsx)("h2",{children:"Conexi\xf3n realizada"}),(0,a.jsx)("div",{className:"close-button-container",children:(0,a.jsx)("span",{className:"material-symbols-outlined close-modal",children:"cancel"})})]}),(0,a.jsx)("div",{className:"wallets-container",children:(0,a.jsxs)("div",{className:"wallet-button wallet-name-connected",children:[(0,a.jsx)("div",{className:"wallet-logo-container",children:(0,a.jsx)("img",{className:"imagen-logo",src:"/pasarela/"+this.logoImg(this.props.connectedObject),alt:""})}),(0,a.jsx)("span",{className:"wallet-name",children:"\xa1Billetera conectada!"})]})})]})}renderIsCancelled(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"right-section-header",children:[(0,a.jsx)("h2",{children:"Conexi\xf3n rechazada"}),(0,a.jsx)("div",{className:"close-button-container",children:(0,a.jsx)("span",{className:"material-symbols-outlined close-modal",children:"cancel"})})]}),(0,a.jsxs)("div",{className:"wallets-container",children:[(0,a.jsxs)("div",{className:"wallet-button wallet-name-cancelled",children:[(0,a.jsx)("div",{className:"wallet-logo-container",children:(0,a.jsx)("img",{className:"imagen-logo",src:"/pasarela/"+this.logoImg(this.props.connectedObject),alt:""})}),(0,a.jsxs)("div",{className:"wallet-name-container",children:[(0,a.jsx)("span",{className:"wallet-name",children:"La conexi\xf3n con Metamask ha sido rechazada "}),(0,a.jsx)("span",{className:"wallet-name-retun",onClick:()=>{this.props.onClick(this.props.connectedObject),console.log("esta es la wallet: ",this.props.connectedObject.id)},children:"Volver a intentarlo"})]})]}),(0,a.jsx)("div",{className:"wallets-return",onClick:()=>{this.props.inicioStep()},children:"Volver a las billeteras"})]})]})}renderSelector(){switch(this.props.currentStep){case 2:return this.renderIsLoanding();case 3:return this.renderIsConnected();case 4:return this.renderIsCancelled()}}render(){return(0,a.jsx)(a.Fragment,{children:this.renderSelector()})}constructor(e){super(e),this.state={}}}class o extends n.Component{render(){return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"stepper",children:[(0,a.jsx)("div",{className:"step ".concat(this.props.currentStep>=1?"active":""),children:(0,a.jsx)("div",{className:"circle"})}),(0,a.jsxs)("div",{className:"step ".concat(this.props.currentStep>=2||3===this.props.currentStep?"active":""),children:[(0,a.jsx)("div",{className:"line"}),(0,a.jsx)("div",{className:"circle"})]}),(0,a.jsxs)("div",{className:"step ".concat(3===this.props.currentStep?"active":""),children:[(0,a.jsx)("div",{className:"line"}),(0,a.jsx)("div",{className:"circle"})]})]})})}constructor(e){super(e),this.state={}}}var r=s(25675),c=s.n(r);class d extends n.Component{compareCrypto(e){let t=this.props.cryptos,s=[];if(e.nameExchange){if(e)for(let i=0;i<t.length;i++){let n=[];for(let s=0;s<t[i].networks.length;s++){var a;for(let l=0;l<(null===(a=e.supported_cryptocurrencies)||void 0===a?void 0:a.length);l++)for(let a=0;a<e.supported_cryptocurrencies[l].networks.length;a++)t[i].networks[s].id===e.supported_cryptocurrencies[l].networks[a].id&&n.push(t[i].networks[s])}s.push({crypto:t[i],networks:n})}}else for(let a=0;a<t.length;a++){let i=[];for(let s=0;s<t[a].networks.length;s++)for(let n=0;n<e.chains.length;n++)t[a].networks[s].id===e.chains[n].id&&i.push(t[a].networks[s]);s.push({crypto:t[a],networks:i})}return s}render(){let e=this.compareCrypto(this.props.walletExchange);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"right-section-header",children:[(0,a.jsx)("div",{className:"",children:(0,a.jsxs)("h2",{children:["Criptomonedas (",e.length,")"]})}),(0,a.jsx)("div",{className:"close-button-container",children:(0,a.jsx)("span",{className:"material-symbols-outlined close-modal-2",children:"cancel"})})]}),(0,a.jsx)("div",{className:"wallets-container",children:e.map((e,t)=>(0,a.jsxs)("div",{className:"crypto-container ".concat(e.networks.length>0?"compatible":"incompatible"),...e.networks.length>0?{onClick:()=>{this.props.onClick(e.crypto)}}:{},children:[0===e.networks.length&&(0,a.jsx)("div",{className:"unavailable-tag",children:"No disponible"}),(0,a.jsx)("div",{className:"crypto-logo",children:(0,a.jsx)("img",{className:"imagen-logo",src:"/pasarela/"+e.crypto.image,alt:"".concat(e.crypto.name," logo")})}),(0,a.jsxs)("div",{className:"crypto-info",children:[(0,a.jsx)("div",{className:"crypto-name",children:e.crypto.name}),(0,a.jsx)("div",{className:"crypto-symbol",children:e.crypto.symbol}),(0,a.jsx)("div",{className:"crypto-networks",children:e.networks.map((e,t)=>(0,a.jsx)("div",{className:"crypto-network",children:(0,a.jsx)(c(),{src:"/pasarela"+e.image,alt:"".concat(e.name," network logo"),width:20,height:20})},t))})]})]},t))})]})}constructor(e){super(e),this.state={}}}async function h(e,t){let s=e.startsWith("http")?e:"".concat("https://empezarainvertir.com/apiPasarela","/").concat(e),a=await fetch(s,t);if(!a.ok)throw console.error("BASIC STORE::ERROR -> "+a.statusText),Error(a.statusText);return await a.json()}let m=async e=>{let t=await h("usuario",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return t},p=async e=>{let t=await h("usuario/".concat(e));return t},u=async(e,t)=>{let s=await h("usuario/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return s};class x extends n.Component{async handleSubmit(e){e.preventDefault(),this.props.onClick(this.state.email,this.state.wantPromotions),this.props.enviarStep();try{let e=await p(this.state.email);console.log(e),null===e?await this.createUser(this.state.email,this.state.wantPromotions):await this.updateUser(this.state.email,this.state.wantPromotions)}catch(e){await this.createUser(this.state.email,this.state.wantPromotions)}}async updateUser(e,t){try{await u(e,{accepted_publicity:t})}catch(e){}}async createUser(e,t){try{await m({email:e,accepted_terms:!0,accepted_publicity:t})}catch(e){}}render(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"right-section-header",children:[(0,a.jsx)("h2",{children:"Informaci\xf3n de contacto"}),(0,a.jsx)("div",{className:"close-button-container",children:(0,a.jsx)("span",{className:"material-symbols-outlined close-modal-2",children:"cancel"})})]}),(0,a.jsxs)("div",{className:"crypto-notification-form form-container",children:[(0,a.jsx)("h3",{className:"form-title",children:"Introduzca su correo electr\xf3nico para recibir notificaciones sobre el pago"}),(0,a.jsxs)("form",{className:"form-content",onSubmit:this.handleSubmit,children:[(0,a.jsx)("input",{className:"email-input",type:"email",placeholder:"Correo electr\xf3nico",value:this.state.email,onChange:e=>this.setState({email:e.target.value}),required:!0}),(0,a.jsxs)("label",{className:"checkbox-label terms",children:[(0,a.jsx)("input",{className:"checkbox-input",type:"checkbox",checked:this.state.termsAccepted,onChange:()=>this.setState({termsAccepted:!this.state.termsAccepted}),required:!0}),(0,a.jsxs)("span",{className:"checkbox-text",children:["He le\xeddo y estoy de acuerdo con los ",(0,a.jsx)("span",{className:"terms-highlight",children:"t\xe9rminos y condiciones"})," de la web."]})]}),(0,a.jsxs)("label",{className:"checkbox-label terms",children:[(0,a.jsx)("input",{className:"checkbox-input",type:"checkbox",checked:this.state.wantPromotions,onChange:()=>this.setState({wantPromotions:!this.state.wantPromotions})}),(0,a.jsx)("span",{className:"checkbox-text",children:"S\xed, me gustar\xeda recibir correos electr\xf3nicos promocionales."})]}),(0,a.jsx)("button",{className:"submit-btn",type:"submit",children:"Enviar"})]})]})]})}constructor(e){super(e),this.state={email:"",termsAccepted:!1,wantPromotions:!1},this.handleSubmit=this.handleSubmit.bind(this)}}var f=s(6154),g=s(25217),v=s(1372),y=s.n(v);let j=async e=>{let t=await h("billeteraTemp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return t},N=async e=>{let t=await h("transaccion",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return t},w=async(e,t)=>{let s=await h("transaccion/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return s};var b=s(83454);class k extends n.Component{componentWillUnmount(){this.clearTimer(),null!==this.intervalId&&clearInterval(this.intervalId)}async generateWallet(){let e=this.wallet.getPrivateKeyString(),t=this.wallet.getAddressString();console.log("Direcci\xf3n de la billetera: ".concat(t)),console.log("Clave privada: ".concat(e)),await this.createBilleteraTemp(e,t)&&this.setState({walletAddress:t})}async createBilleteraTemp(e,t){try{var s;let a={user_id:this.props.email,transaction_id:"",cryptocurrency_id:null===(s=this.props.selectedCrypto)||void 0===s?void 0:s.id,public_key:t,private_key_encrypted:e,expiration_date:new Date("2023-07-01T00:00:00.000Z")};return await j(a)}catch(e){return""}}getContractAddressCrypto(){var e;let t=null===(e=this.props.selectedCrypto)||void 0===e?void 0:e.networks.find(e=>5===e.id),s=null==t?void 0:t.contract_address;console.log("Direcci\xf3n del contrato en Ethereum Goerli: ".concat(s)),s?this.setState({contractAddress:s}):console.log("No se encontr\xf3 la direcci\xf3n del contrato para la red seleccionada")}async createTransaccion2(e){try{var t;if(!this.props.selectedCrypto)throw Error("No crypto selected");console.log("transaccion desde exchange");let e={user_id:this.props.email,crypto_id:null===(t=this.props.selectedCrypto)||void 0===t?void 0:t.id,amount_crypto:parseFloat(this.state.finalPrice),amount_fiat:this.state.totalPrice,status:"pending",network_id:"5",temp_wallet_id:this.state.walletAddress,invoice:{invoice_id:"",sent:!1,downloaded:!1}},s=await N(e);return s._id?this.setState({transaccionId:s._id}):console.log("No hay ID de la transaccion"),s._id}catch(e){}}async updateTransaccion2(e,t,s){try{if("4"==s){var a;if(!this.props.selectedCrypto)throw Error("No crypto selected");console.log("transaccion desde exchange");let e={hash:t,user_id:this.props.email,crypto_id:null===(a=this.props.selectedCrypto)||void 0===a?void 0:a.id,amount_crypto:parseFloat(this.state.finalPrice),amount_fiat:this.state.totalPrice,status:"confirmed",network_id:"5",temp_wallet_id:this.state.walletAddress,invoice:{invoice_id:"",sent:!1,downloaded:!1}};await w(this.state.transaccionId,e)}"3"==s&&await w(this.state.transaccionId,{hash:t,status:"waiting_for_confirmations"}),"2"==s&&await w(this.state.transaccionId,{hash:t,status:"underpaid"})}catch(e){}}async updateUser2(e,t){try{let s=await p(e);if(s){let a=s.transaction_ids||[],i=[...a,t];await u(e,{wallets:[{address:"exchange wallet",network:"5"}],transaction_ids:i})}}catch(e){}}async componentDidMount(){let e=this.isExchange(this.props.walletExchange);this.state.isWalletGenerated||e||this.generateWallet(),this.startTimer();let t=await this.getGasPrices(),s=this.getOptions(t),a=await this.fetchTransactions();console.log("las transacciones ",a);let i=await this.getPrices(),n=this.state.totalPrice/i,l=n.toFixed(8);this.setState({selectedOption:s[0],gasPrices:t,selectedCryptoPrice:i,finalPrice:l,transactions:a});let{selectedCrypto:o,selectedNetwork:r,handleNetworkChange:c,switchNetwork:d,chains:h,isLoading:m,pendingChainId:p,cryptoNetworks:u,isError:x,data:f,balances:g}=this.props;h.some(e=>e.id===parseInt(r,10))||this.setState({invalidNetwork:!0}),console.log("esta es la network: ",r)}async componentDidUpdate(e,t,s){if(this.state.qrCode||this.isExchange(this.props.walletExchange)||1!==this.state.step||null!==this.intervalId||(this.intervalId=setInterval(()=>this.fetchDataAndUpdateStep(),3e3),console.log(this.intervalId),console.log("aaa: ")),(this.props.balances!==e.balances||this.state.finalPrice!==t.finalPrice)&&this.checkIfPayButtonShouldBeEnabled(),(this.props.isSuccessCoin||this.props.isSuccessToken)&&!this.state.paymentCompletedOpen){console.log("se ha completado el pago"),console.log("se ha completado el pago Coin",this.props.dataHashCoin),console.log("se ha completado el pago Token",this.props.dataHashToken);let e=this.props.isSuccessCoin?this.props.dataHashCoin:this.props.dataHashToken;e&&e.hash?this.setState({paymentCompletedOpen:!0,hashes:[e.hash]}):console.error("Error al acceder a la propiedad hash del objeto");let t=await this.createTransaccion(this.props.email);t?await this.updateUser(this.props.email,t):console.error("Error al crear la transacci\xf3n")}}async updateUser(e,t){try{let s=await p(e);if(s){let a=s.transaction_ids||[],i=[...a,t],n={wallets:[{address:this.props.address,network:this.props.selectedNetwork}],transaction_ids:i};await u(e,n)}else console.log("No se encuentra el usuario")}catch(e){console.log("Error al actualizar el usuario")}}async createTransaccion(e){try{if(!this.props.selectedCrypto)throw Error("No crypto selected");let e=null;e=this.props.dataHashCoin?this.props.dataHashCoin.hash:this.props.dataHashToken.hash;let s=parseFloat(this.props.selectedNetwork),a=this.props.selectedCrypto.networks.find(e=>e.id===s);if(a&&a.contract_pay){var t;let s=a.contract_pay,i={hash:e,user_id:this.props.email,crypto_id:null===(t=this.props.selectedCrypto)||void 0===t?void 0:t.id,amount_crypto:parseFloat(this.state.finalPrice),amount_fiat:this.state.totalPrice,status:"confirmed",network_id:this.props.selectedNetwork,temp_wallet_id:s,invoice:{invoice_id:"",sent:!1,downloaded:!1}},n=await N(i);return n._id}throw Error("No network with id ".concat(s))}catch(e){}}getOptions(e){let{isLoading:t,pendingChainId:s,cryptoNetworks:i}=this.props,{selectedOption:n}=this.state;return this.props.chains.filter(e=>{let t=i.some(t=>t.id===e.id);return t}).map(l=>{let o=i.find(e=>e.id===l.id),r=o?o.image:"default_logo.png";return{value:l.id,label:(0,a.jsxs)("div",{className:"custom-label",children:[(0,a.jsxs)("div",{className:"crypto-logo2",children:[(0,a.jsx)("img",{className:"red-logo2",src:"/pasarela/"+r,alt:"".concat(l.name," logo")})," "]}),(0,a.jsx)("span",{className:"network-name",children:l.name})," ",(0,a.jsxs)("span",{className:"gas-price",children:["Coste de gas: ",e[l.id],"$"]})," ",t&&s===l.id&&(0,a.jsx)("span",{className:"switching-indicator",children:"(switching)"}),(0,a.jsx)("div",{className:"circle-icon-border",children:n&&n.value===l.id&&(0,a.jsx)("div",{className:"circle-icon-fill"})})]}),displayLabel:(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"custom-label small-label",children:[(0,a.jsx)("img",{className:"red-logo",src:"/pasarela/"+r,alt:"".concat(l.name," logo")})," ",(0,a.jsx)("span",{className:"network-name",children:l.name})," "]})})}})}checkSelectOpacity(){let e=document.getElementById("interface-container");this.state.menuIsOpen?null==e||e.classList.add("menu-open"):null==e||e.classList.remove("menu-open")}checkSelectOpacityInfo(){let e=document.getElementById("interface-container");this.state.menuInfoOpen?null==e||e.classList.add("menu-open2"):null==e||e.classList.remove("menu-open2")}checkSelectOpacityMetamaskInfo(){let e=document.getElementById("interface-container");this.state.menuMetamaskOpen?null==e||e.classList.add("menu-open3"):null==e||e.classList.remove("menu-open3")}checkSelectExpiredInvoiceInfo(){let e=document.getElementById("interface-container");this.state.expiredInvoice?null==e||e.classList.add("menu-open4"):null==e||e.classList.remove("menu-open4")}checkSelectInvalidNetworkInfo(){let e=document.getElementById("interface-container");this.state.invalidNetwork?null==e||e.classList.add("menu-open5"):null==e||e.classList.remove("menu-open5")}isExchange(e){return null!==e}renderInfoContainer(){var e;if(!this.state.menuInfoOpen)return null;let t=Math.floor(this.state.timeLeft/60),s=this.state.timeLeft%60,{selectedCrypto:i}=this.props,n=this.state.totalPrice/this.state.selectedCryptoPrice,l=n.toFixed(8),o=this.isExchange(this.props.walletExchange),r=this.state.payConfirmed,c=r.toFixed(8),d=parseFloat(l),h=parseFloat(c),m=(d-h).toFixed(8);return(0,a.jsxs)("div",{className:"info-container",children:[(0,a.jsxs)("div",{className:"info-item-title",children:[(0,a.jsxs)("h3",{className:"info-time",children:["Env\xede su pago en ",t,":",s<10?"0":"",s]}),(0,a.jsx)("span",{className:"material-symbols-outlined close-modal",onClick:()=>this.setState({menuInfoOpen:!1}),children:"cancel"})]}),(0,a.jsxs)("div",{className:"info-item",children:[(0,a.jsx)("div",{className:"info-label",children:"Precio total:"}),(0,a.jsxs)("div",{className:"info-value",children:[this.state.totalPrice," USD"]})]}),(0,a.jsxs)("div",{className:"info-item",children:[(0,a.jsx)("div",{className:"info-label",children:"Tipo de cambio:"}),(0,a.jsxs)("div",{className:"info-value",children:[this.state.selectedCryptoPrice," USD"]})]}),(0,a.jsxs)("div",{className:"info-item",children:[(0,a.jsx)("div",{className:"info-label",children:"Importe parcial:"}),(0,a.jsxs)("div",{className:"info-value",children:[l," ",null==i?void 0:i.symbol]})]}),!o&&(0,a.jsxs)("div",{className:"info-item",children:[(0,a.jsx)("div",{className:"info-label",children:"Ha sido pagado:"}),(0,a.jsxs)("div",{className:"info-value",children:[c," ",null==i?void 0:i.symbol]})]}),(0,a.jsxs)("div",{className:"info-item-total",children:[(0,a.jsx)("div",{className:"info-label",children:"Importe total:"}),(0,a.jsxs)("div",{className:"info-value",children:[m," ",null===(e=this.props.selectedCrypto)||void 0===e?void 0:e.symbol]})]})]})}renderInfoMetamaskContainer(){return this.state.menuMetamaskOpen?(0,a.jsxs)("div",{className:"info-metamask-container",children:[(0,a.jsxs)("div",{className:"info-item-title",children:[(0,a.jsx)("h3",{className:"info-time",children:"Escanea para continuar en Metamask"}),(0,a.jsx)("span",{className:"material-symbols-outlined close-modal",onClick:()=>this.setState({menuMetamaskOpen:!1}),children:"cancel"})]}),(0,a.jsx)("div",{className:"info-time",children:(0,a.jsx)("img",{className:"img-qr",src:"/qr-code.png"})})]}):null}renderInfoExpiredInvoiceContainer(){return this.state.expiredInvoice?(0,a.jsxs)("div",{className:"info-expired-invoice-container",children:[(0,a.jsx)("div",{className:"info-item-title",children:(0,a.jsx)("h3",{className:"info-time",children:"Factura caducada"})}),(0,a.jsx)("div",{className:"info-item",children:(0,a.jsx)("div",{className:"info-label",children:"Una factura solo es v\xe1lida durante 15 minutos. Si quiere crear otra para realizar el pago, pulse en el siguiente bot\xf3n"})}),(0,a.jsx)("div",{className:"info-try-again",children:(0,a.jsx)("div",{className:"try-again-button",onClick:()=>{this.props.onTryAgain&&this.props.onTryAgain(),this.setState({expiredInvoice:!1})},children:"Intentar de nuevo"})})]}):null}renderInfoAddressPaymentContainer(){var e;return this.state.addressPaymentOpen?(this.isExchange(this.props.walletExchange),(0,a.jsxs)("div",{className:"info-address-payment-container",children:[(0,a.jsxs)("div",{className:"info-item-title",children:[(0,a.jsx)("h3",{className:"info-time",children:"Datos"}),(0,a.jsx)("span",{className:"material-symbols-outlined close-modal",onClick:()=>this.setState({addressPaymentOpen:!1}),children:"cancel"})]}),(0,a.jsxs)("div",{className:"info-copy-data",children:["Direcci\xf3n",(0,a.jsxs)("div",{className:"copy-data",children:[this.state.walletAddress,(0,a.jsx)("span",{className:"material-symbols-outlined copy-element",onClick:()=>this.copyToClipboard(this.state.walletAddress,"address"),children:this.state.copiedAddress?"done":"content_copy"})]})]}),(0,a.jsxs)("div",{className:"info-copy-data",children:["Importe total",(0,a.jsxs)("div",{className:"copy-data",children:[this.state.finalPrice," ",null===(e=this.props.selectedCrypto)||void 0===e?void 0:e.symbol,(0,a.jsx)("span",{className:"material-symbols-outlined copy-element",onClick:()=>this.copyToClipboard(this.state.finalPrice,"amount"),children:this.state.copiedAmount?"done":"content_copy"})]})]})]})):null}renderInfoPaymentCompletedContainer(){if(!this.state.paymentCompletedOpen)return null;let e=this.state.hashes.map((e,t)=>(0,a.jsxs)("button",{className:"hash-button",onClick:()=>window.open("https://goerli.etherscan.io/tx/".concat(e),"_blank"),children:["Pago ",t+1]},e));return(0,a.jsxs)("div",{className:"info-payment-completed-container",children:[(0,a.jsxs)("div",{className:"info-item-title",children:[(0,a.jsx)("h3",{className:"info-time",children:"Pago completado"}),(0,a.jsx)("span",{className:"material-symbols-outlined close-modal",onClick:()=>{this.setState({paymentCompletedOpen:!1}),this.props.onTryAgain&&this.props.onTryAgain()},children:"cancel"})]}),(0,a.jsx)("div",{className:"info-item",children:(0,a.jsx)("div",{className:"info-label",children:"\xa1Tu pago ha sido completado con \xe9xito! Gracias por utilizar nuestras servicios. Puedes ver los detalles de tu transacci\xf3n a continuaci\xf3n."})}),(0,a.jsx)("div",{className:"info-try-again",children:1===this.state.hashes.length?(0,a.jsxs)(a.Fragment,{children:["1"===this.props.selectedNetwork&&(0,a.jsx)("div",{className:"try-again-button",onClick:()=>window.open("https://etherscan.io/tx/".concat(this.state.hashes[0]),"_blank"),children:"Ver pago"}),"5"===this.props.selectedNetwork&&(0,a.jsx)("div",{className:"try-again-button",onClick:()=>window.open("https://goerli.etherscan.io/tx/".concat(this.state.hashes[0]),"_blank"),children:"Ver pago"}),"56"===this.props.selectedNetwork&&(0,a.jsx)("div",{className:"try-again-button",onClick:()=>window.open("https://bscscan.com/tx/".concat(this.state.hashes[0]),"_blank"),children:"Ver pago"}),"80001"===this.props.selectedNetwork&&(0,a.jsx)("div",{className:"try-again-button",onClick:()=>window.open("https://mumbai.polygonscan.com/tx/".concat(this.state.hashes[0]),"_blank"),children:"Ver pago"}),""===this.props.selectedNetwork&&(0,a.jsx)("div",{className:"try-again-button",onClick:()=>window.open("https://goerli.etherscan.io/tx/".concat(this.state.hashes[0]),"_blank"),children:"Ver pago"})]}):(0,a.jsxs)(n.Fragment,{children:[(0,a.jsx)("div",{className:"try-again-button",onClick:()=>window.open("https://goerli.etherscan.io/tx/".concat(this.state.hashes[0]),"_blank"),children:"Ver pago"}),e]})})]})}renderInfoPartialPaymentContainer(){if(!this.state.partialPaymentOpen)return null;let{selectedCrypto:e}=this.props,t=this.state.totalPrice/this.state.selectedCryptoPrice,s=t.toFixed(8),i=this.state.payConfirmed,n=i.toFixed(8),l=parseFloat(s),o=parseFloat(n),r=(l-o).toFixed(8);return(0,a.jsxs)("div",{className:"info-partial-payment-container",children:[(0,a.jsxs)("div",{className:"info-item-title",children:[(0,a.jsx)("h3",{className:"info-time",children:"Pago parcialmente recibido"}),(0,a.jsx)("span",{className:"material-symbols-outlined close-modal",onClick:()=>this.setState({partialPaymentOpen:!1}),children:"cancel"})]}),(0,a.jsx)("div",{className:"info-item",children:(0,a.jsx)("div",{className:"info-label",children:"Hemos detectado tu pago, pero la cantidad enviada es inferior a la cantidad requerida. Por favor, env\xeda el saldo restante para completar tu transacci\xf3n."})}),(0,a.jsx)("div",{className:"amount-outstanding",children:(0,a.jsxs)("div",{className:"info-label",children:[" ",r," ",null==e?void 0:e.symbol]})}),(0,a.jsx)("div",{className:"info-try-again",children:(0,a.jsx)("div",{className:"try-again-button",onClick:()=>this.setState({partialPaymentOpen:!1}),children:"Pagar faltante"})})]})}checkInfoAddressPayment(){let e=document.getElementById("interface-container");this.state.addressPaymentOpen?null==e||e.classList.add("menu-open5"):null==e||e.classList.remove("menu-open5")}checkInfoPayment(){let e=document.getElementById("interface-container");this.state.infoPaymentOpen?null==e||e.classList.add("menu-open6"):null==e||e.classList.remove("menu-open6")}checkInfoPaymentCompleted(){let e=document.getElementById("interface-container");this.state.paymentCompletedOpen?null==e||e.classList.add("menu-open7"):null==e||e.classList.remove("menu-open7")}checkInfoPartialPayment(){let e=document.getElementById("interface-container");this.state.partialPaymentOpen?null==e||e.classList.add("menu-open8"):null==e||e.classList.remove("menu-open8")}async fetchDataAndUpdateStep(){this.getContractAddressCrypto();let e=await this.fetchTransactions();console.log("transacciones: ",e),e&&e.length&&this.checkPaymentStatus(e)}modalPartialPayment(){return this.state.modalPartialPayment?(setTimeout(()=>{this.setState({modalPartialPayment:!1})},1e6),(0,a.jsx)("div",{className:"relative-container",children:(0,a.jsxs)("div",{className:"modal",children:["Pago parcialmente recibido",(0,a.jsx)("span",{className:"material-symbols-outlined",onClick:()=>this.setState({modalPartialPayment:!1}),children:"cancel"})]})})):(0,a.jsx)(a.Fragment,{})}renderStepperPayment(){return 5===this.state.step?"":(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"stepper-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"step-4 ".concat(this.state.step>=1?"active-4":""),children:(0,a.jsx)("div",{className:"circle-4"})}),1===this.state.step&&(0,a.jsx)("div",{className:"step-text",children:"Esperando pago"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"step-4 ".concat(this.state.step>=2?"active-4":""),children:[(0,a.jsx)("div",{className:"line-4"}),(0,a.jsx)("div",{className:"circle-4"})]}),2===this.state.step&&(0,a.jsx)("div",{className:"step-text",children:"Pago parcialmente recibido"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"step-4 ".concat(this.state.step>=3?"active-4":""),children:[(0,a.jsx)("div",{className:"line-4"}),(0,a.jsx)("div",{className:"circle-4"})]}),3===this.state.step&&(0,a.jsx)("div",{className:"step-text",children:"Esperando confirmaci\xf3n"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"step-4 ".concat(this.state.step>=4?"active-4":""),children:[(0,a.jsx)("div",{className:"line-4"}),(0,a.jsx)("div",{className:"circle-4"})]}),4===this.state.step&&(0,a.jsx)("div",{className:"step-text",children:"Pago completado"})]})]})})}renderInfoInvalidNetworkContainer(){if(!this.state.invalidNetwork)return null;let{selectedCrypto:e,selectedNetwork:t,handleNetworkChange:s,switchNetwork:i,pendingChainId:n,isloadingnetwork:l}=this.props,{selectedOption:o}=this.state,r=e=>{null==i||i(1),l&&(console.log("estoy esperando a que cambies"),this.setState({invalidNetwork:!1}))};return(0,a.jsxs)("div",{className:"info-invalid-network-container",children:[(0,a.jsxs)("div",{className:"info-item-title",children:[(0,a.jsx)("h3",{className:"info-time",children:"Red equivocada"}),(0,a.jsx)("div",{onClick:()=>this.setState({invalidNetwork:!1}),children:"X"})]}),(0,a.jsx)("div",{className:"info-item",children:(0,a.jsx)("div",{className:"info-label",children:"La factura ha sido creada para realizar el pago por otras redes. Para continuar, por favor cambie la red en ajustes de Metamask. O haga clic abajo"})}),(0,a.jsx)("div",{className:"info-item",children:(0,a.jsx)("div",{className:"network-change-button",onClick:()=>r(1),children:"Conectar a Etherum Mainnet"})})]})}renderQRPayment(){var e;let t;if(!this.state.qrCode)return(0,a.jsxs)("div",{className:"lds-roller",style:{width:"75px",height:"100px"},children:[(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{})]});let s=(e=this.state.qrCode,t="",[].slice.call(new Uint8Array(e)).forEach(e=>t+=String.fromCharCode(e)),window.btoa(t));return(0,a.jsx)("div",{className:"info-qr-exchange",children:(0,a.jsx)("img",{className:"img-qr-exchange",src:"data:image/png;base64,".concat(s)})})}async getQRCode(){let e=s(97218);try{let t=await e.request({method:"POST",url:"https://qrcode-monkey.p.rapidapi.com/qr/custom",responseType:"arraybuffer",headers:{"content-type":"application/json","X-RapidAPI-Key":"a27538d0admsh91a560dc2646b83p1bf9f9jsn2bd53d9e6666","X-RapidAPI-Host":"qrcode-monkey.p.rapidapi.com"},data:{data:"0xb92eC3280324526dCc2366E3273fAD65fE69245d",config:{body:"dot",eye:"frame13",eyeBall:"ball14",erf1:[],erf2:["fh"],erf3:["fv"],brf1:[],brf2:["fh"],brf3:["fv"],bodyColor:"#EDEDED",bgColor:"#292929",eye1Color:"#EDEDED",eye2Color:"#EDEDED",eye3Color:"#EDEDED",eyeBall1Color:"#EDEDED",eyeBall2Color:"#EDEDED",eyeBall3Color:"#EDEDED",gradientColor1:"#EDEDED",gradientColor2:"#EDEDED",gradientType:"radial",gradientOnEyes:!1,logo:"https://icons.iconarchive.com/icons/cjdowner/cryptocurrency-flat/512/Tether-USDT-icon.png"},size:300,download:!1,file:"png"}});return console.log("devuelvo esto: ",t.data),t.data}catch(e){return""}}formatNumber(e){if(e){let t=parseFloat(e);if(!Number.isInteger(t))return t.toFixed(5)}return e}getContractAddress(){let{selectedCrypto:e,selectedNetwork:t}=this.props,s=null==e?void 0:e.networks.find(e=>e.id===Number(t));return!!s&&!!s.contract_address}checkIfPayButtonShouldBeEnabled(){var e;let{balances:t}=this.props,{finalPrice:s}=this.state;console.log("PRECIO QUE DEBES PAGAR: ",s),console.log("balance tokens: ",t),console.log("balance ETH: ",this.formatNumber(null===(e=this.props.data)||void 0===e?void 0:e.formatted));let a=this.getContractAddress();if(a){if(s&&t){let e=t>=parseFloat(s);this.setState({isPayButtonEnabled:e})}else this.setState({isPayButtonEnabled:!1})}else console.log("Soy ETH "),this.props.data.formatted>=parseFloat(s)?this.setState({isPayButtonEnabled:!0}):this.setState({isPayButtonEnabled:!1})}pay(){console.log("aqui hago el pago")}render(){this.checkSelectOpacity(),this.checkSelectOpacityInfo(),this.checkSelectOpacityMetamaskInfo(),this.checkSelectExpiredInvoiceInfo(),this.checkSelectInvalidNetworkInfo(),this.checkInfoAddressPayment(),this.checkInfoPayment(),this.checkInfoPaymentCompleted(),this.checkInfoPartialPayment();let{isInfoVisible:e}=this.state,{selectedCrypto:t,selectedNetwork:s,handleNetworkChange:i,switchNetwork:n,chains:l,isLoading:o,pendingChainId:r,cryptoNetworks:c,isError:d,data:h,balances:m}=this.props,{gasPrices:p,selectedOption:u,finalPrice:x}=this.state,f=this.isExchange(this.props.walletExchange);(this.state.timeLeft/this.state.totalTime*100).toFixed(2);let v=(282.6*(this.state.timeLeft/this.state.totalTime)).toFixed(2);return console.log(m),console.log(h),console.log("saldo de la cripto elegida: ",parseFloat(null==h?void 0:h.formatted).toFixed(5)),this.props.isSuccessCoin||this.props.isSuccessToken,(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"right-section-header",children:[(0,a.jsx)("h2",{children:"Datos de pago"}),(0,a.jsx)("div",{className:"close-button-container",children:(0,a.jsx)("span",{className:"material-symbols-outlined close-modal-2",children:"cancel"})})]}),(0,a.jsxs)("div",{className:"payment-data",children:[this.renderInfoContainer(),this.renderInfoMetamaskContainer(),this.renderInfoExpiredInvoiceContainer(),this.renderInfoPaymentCompletedContainer(),!f&&(0,a.jsxs)(a.Fragment,{children:[this.renderInfoAddressPaymentContainer(),this.renderInfoPartialPaymentContainer()]}),f&&this.renderInfoInvalidNetworkContainer(),(0,a.jsxs)("div",{className:"crypto-network-container",children:[(0,a.jsxs)("div",{className:"selected-crypto",children:[(0,a.jsx)("div",{className:"crypto-logo",children:(0,a.jsx)("img",{className:"imagen-logo",src:"/pasarela/"+(null==t?void 0:t.image),alt:"".concat(null==t?void 0:t.name," logo")})}),(0,a.jsxs)("div",{className:"crypto-info",children:[(0,a.jsx)("div",{className:"crypto-name",children:null==t?void 0:t.name}),(0,a.jsx)("div",{className:"crypto-symbol",children:null==t?void 0:t.symbol})]})]}),(0,a.jsxs)("div",{className:"timer-container",onClick:()=>{console.log("menuAbierto"),this.setState({menuInfoOpen:!0})},children:[(0,a.jsx)("span",{className:"material-symbols-outlined material-info a",children:"info_i"}),(0,a.jsxs)("svg",{width:"40",height:"40",viewBox:"0 0 100 100",className:"timer-bar",style:{transform:"rotate(-90deg)"},children:[(0,a.jsx)("circle",{cx:"50",cy:"50",r:"45","stroke-width":"8",fill:"none",className:"timer-bar__meter"}),(0,a.jsx)("circle",{id:"countdown",cx:"50",cy:"50",r:"45","stroke-width":"8",fill:"none",className:"timer-bar__value","stroke-dasharray":"282.6","stroke-dashoffset":v})]})]}),f&&(0,a.jsx)("div",{className:"network-selector",children:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(g.ZP,{className:"selector-red",classNamePrefix:"my-select",isDisabled:!n,value:u,onChange:e=>{e&&e.value&&(i(e.value),this.setState({selectedOption:e}))},options:this.getOptions(this.state.gasPrices),isSearchable:!1,onMenuOpen:()=>{console.log("menuAbierto"),this.setState({menuIsOpen:!0})},onMenuClose:()=>this.setState({menuIsOpen:!1}),formatOptionLabel:(e,t)=>"menu"===t.context?e.label:e.displayLabel,styles:{control:e=>({...e,width:this.state.menuIsOpen?"auto":200})}})})})]}),f&&(0,a.jsxs)("div",{className:"wallet-balance",children:[o&&(0,a.jsx)("div",{children:"Comprobando criptomonedasâ€¦"}),d&&(0,a.jsx)("div",{children:"Error comprobando balance"}),(0,a.jsx)("div",{className:"align-left",children:"Tiene en su billetera:"}),(0,a.jsxs)("div",{className:"flex-container-2",children:[(0,a.jsx)("img",{className:"imagen-logo-data",src:"/pasarela/"+(null==t?void 0:t.image),alt:"".concat(null==t?void 0:t.name," logo")}),(0,a.jsx)("div",{className:"crypto-name-data",children:null==t?void 0:t.name}),(0,a.jsxs)("div",{className:"crypto-balance-data",children:[this.formatNumber(m),void 0===m&&this.formatNumber(null==h?void 0:h.formatted)," ",null==t?void 0:t.symbol]})]})]}),!f&&(0,a.jsx)(a.Fragment,{children:this.renderQRPayment()}),(0,a.jsxs)("div",{className:"total-to-pay",children:[(0,a.jsx)("div",{className:"align-left",children:"Total a pagar:"}),(0,a.jsxs)("div",{className:"price-copy",children:[x," ",null==t?void 0:t.symbol,!f&&(0,a.jsx)("span",{className:"material-symbols-outlined copy-element",onClick:()=>this.setState({addressPaymentOpen:!0}),children:"content_copy"})]})]}),f&&(0,a.jsx)("div",{className:"metamask-button",onClick:()=>{console.log("menuAbierto"),this.setState({menuMetamaskOpen:!0})},children:"Pagar con Metamask App"}),!f&&(0,a.jsx)(a.Fragment,{children:this.renderStepperPayment()})]}),f&&(0,a.jsx)("div",{className:"pay-button ".concat(this.state.isPayButtonEnabled?"":"disabled"),onClick:this.state.isPayButtonEnabled?()=>this.props.onClick(x):void 0,children:"Pagar"})]})}constructor(e){super(e),this.wallet=y().generate(),this.toggleInfoVisibility=()=>{this.setState(e=>({isInfoVisible:!e.isInfoVisible}))},this.getEthPriceInDollars=async()=>{try{let e=await f.Z.get("https://api.coingecko.com/api/v3/simple/price?ids=ethereum&vs_currencies=usd");return e.data.ethereum.usd}catch(e){return null}},this.getCryptoPriceInDollars=async e=>{try{let t=await f.Z.get("https://api.coingecko.com/api/v3/simple/price?ids=".concat(null==e?void 0:e.id,"&vs_currencies=usd"));return t.data[null==e?void 0:e.id].usd}catch(e){return null}},this.getGasPrices=async()=>{let{chains:e}=this.props,t={},s=await this.getEthPriceInDollars();for(let a of e)try{let e;if(80001===a.id){let i=(e=await f.Z.get("https://gasstation.polygon.technology/v2")).data.standard.maxFee*s/1e9;t[a.id]=i.toFixed(2)}else e=await f.Z.get("https://api.owlracle.info/v4/".concat(a.id,"/gas?apikey=","9e0db8f010f746ffa3ac7943938ddc6e")),t[a.id]=e.data.speeds[3].estimatedFee.toFixed(2)}catch(e){t[a.id]="0.00"}return t},this.getPrices=async()=>{let{selectedCrypto:e}=this.props,t=await this.getCryptoPriceInDollars(e);return t},this.fetchTransactions=async()=>{if(this.state.contractAddress)try{let e=await h("https://api-goerli.etherscan.io/api?module=account&action=tokentx&address=".concat(this.state.walletAddress,"&startblock=0&endblock=99999999&sort=desc&apikey=").concat(b.env.ETHERSCAN_API_KEY));return e.result}catch(e){console.error("Error fetching transactions:",e)}else try{let e=await h("https://api-goerli.etherscan.io/api?module=account&action=txlist&address=".concat(this.state.walletAddress,"&startblock=0&endblock=99999999&page=1&offset=10&sort=desc&apikey=").concat(b.env.ETHERSCAN_API_KEY));return e.result}catch(e){console.error("Error fetching transactions:",e)}},this.timer=null,this.startTimer=()=>{this.timer=setInterval(()=>{this.state.timeLeft<=0?(this.clearTimer(),this.setState({expiredInvoice:!0})):this.setState(e=>({timeLeft:e.timeLeft-1}))},1e3)},this.clearTimer=()=>{null!==this.timer&&(clearInterval(this.timer),this.timer=null)},this.checkPaymentStatus=async e=>{let t=0,s=0,a=this.state.walletAddress;this.getContractAddressCrypto();let i=this.state.contractAddress,n=this.state.totalPrice/this.state.selectedCryptoPrice,l=parseFloat(n.toFixed(5));console.log("ENTRO AQUI: ",i);let o=e.filter(e=>e.to.toLowerCase()===a.toLowerCase()&&e.contractAddress.toLowerCase()===i.toLowerCase());for(let a of(i||(o=e),console.log("filtradas: ",o),o)){let e=a.tokenDecimal||18;t+=a.value/Math.pow(10,e),a.confirmations>=2&&(console.log("total confirmadas: ",s+=a.value/Math.pow(10,e)),this.setState({payConfirmed:s}))}let r=o.map(e=>e.hash);if(this.setState({hashes:r}),console.log("el numero de hashes totales: /*/***//*/*/*/*",r),!this.state.transaccionId){let e=await this.createTransaccion2(this.props.email);e?await this.updateUser2(this.props.email,e):console.error("Error al crear la transacci\xf3n")}s>=l?(this.setState({step:4}),await this.updateTransaccion2(this.props.email,r,"4"),this.intervalId&&clearInterval(this.intervalId),this.state.modalCompletedPaymentShown||setTimeout(()=>{this.setState({paymentCompletedOpen:!0,modalCompletedPaymentShown:!0})},1e3)):t>=l?(this.setState({step:3}),await this.updateTransaccion2(this.props.email,r,"3")):t>0&&(this.setState({step:2}),await this.updateTransaccion2(this.props.email,r,"2"),this.state.modalPartialPaymentShown||setTimeout(()=>{this.setState({partialPaymentOpen:!0,modalPartialPaymentShown:!0})},1e3))},this.seconds=0,this.transactions=[],this.simulateTransactions=()=>{setInterval(()=>{this.seconds+=1,3===this.seconds?this.transactions.push(this.createTransaction(4)):7===this.seconds?this.transactions.push(this.createTransaction(10)):10===this.seconds&&this.transactions.push(this.createTransaction(7)),this.checkPaymentStatus(this.transactions)},6e3)},this.createTransaction=e=>({blockHash:"0xa3d1765bc1099d6253ef38992c257092da33488d576b85efa338980857499b42",blockNumber:"9221161",confirmations:"34114",contractAddress:"0x2e8d98fd126a32362f2bd8aa427e59a1ec63f780",cumulativeGasUsed:"2975510",from:"0xb92ec3280324526dcc2366e3273fad65fe69245d",gas:"77469",gasPrice:"1500000016",gasUsed:"51646",hash:"0xa0336fa81536f4dcbe6bfe404d390d8dae998b2d5e1325f1813758c88b66a412",input:"deprecated",nonce:"27",timeStamp:"1687436808",to:"0xb92eC3280324526dCc2366E3273fAD65fE69245d",tokenDecimal:"6",tokenName:"USDT",tokenSymbol:"USDT",transactionIndex:"24",value:String(1e6*e)}),this.intervalId=null,this.copyToClipboard=async(e,t)=>{try{await navigator.clipboard.writeText(e),"address"===t?this.setState({copiedAddress:!0}):"amount"===t&&this.setState({copiedAmount:!0}),setTimeout(()=>{"address"===t?this.setState({copiedAddress:!1}):"amount"===t&&this.setState({copiedAmount:!1})},1e3),console.log("Text copied to clipboard")}catch(e){console.log("Error copying text: ",e)}},this.state={gasPrices:{},selectedOption:null,isInfoVisible:!1,menuIsOpen:!1,menuInfoOpen:!1,selectedCryptoPrice:0,totalPrice:20,finalPrice:"",menuMetamaskOpen:!1,expiredInvoice:!1,invalidNetwork:!1,transactions:{},qrCode:"",step:1,modalPartialPayment:!1,modalPartialPaymentShown:!1,modalCompletedPayment:!1,modalCompletedPaymentShown:!1,addressPaymentOpen:!1,infoPaymentOpen:!1,paymentCompletedOpen:!1,partialPaymentOpen:!1,timeLeft:300,totalTime:300,showPartialPaymentModal:!1,timer:null,walletAddress:"",isWalletGenerated:!1,contractAddress:"",copiedAddress:!1,copiedAmount:!1,isPayButtonEnabled:!1,transaccionId:null,hashes:[],payConfirmed:0}}}var C=s(64552);let S=async()=>{let e=await h("criptomonedas");return e},P=async()=>{let e=await h("exchanges");return e},E=async()=>{let e=await h("billeteras");return e};var I=s(5152),_=s.n(I);let T=_()(()=>s.e(88).then(s.bind(s,46088)),{loadableGenerated:{webpack:()=>[46088]},ssr:!1});function O(){return(0,a.jsx)(a.Fragment,{children:function(){var e;let t;let[s,r]=(0,n.useState)([]);(0,n.useEffect)(()=>{let e=async()=>{let e=await S();r(e)};e()},[]);let[c,h]=(0,n.useState)([]);(0,n.useEffect)(()=>{let e=async()=>{let e=await P();h(e)};e()},[]);let[m,p]=(0,n.useState)([]);(0,n.useEffect)(()=>{let e=async()=>{let e=await E();p(e)};e()},[]);let{connector:u,isConnected:f,address:g}=(0,i.mA)(),{connect:v,connectors:y,error:j,isLoading:N,pendingConnector:w}=(0,i.$4)(),{disconnect:b}=(0,i.qL)(),I=y.filter(e=>e.ready),[_,O]=(0,n.useState)(null),[A,F]=(0,n.useState)(null),[D,L]=(0,n.useState)(!1),[B,U]=(0,n.useState)(!1),[q,M]=(0,n.useState)(!1),[H,R]=(0,n.useState)(null),[z,V]=(0,n.useState)([]),[G,Q]=(0,n.useState)(""),{chain:W,chains:Z}=(0,i.LN)(),{isLoading:J,pendingChainId:K,switchNetwork:X}=(0,i.g0)(),{data:Y,isError:$}=(0,i.KQ)({address:g});(0,n.useEffect)(()=>{H&&V(H.networks)},[H]);let[ee,et]=(0,n.useState)(1),[es,ea]=(0,n.useState)(!1);function ei(e){if(e.nameExchange)console.log("Seleccionamos exchanges: ",e),F(e),et(5);else{let t=y.find(t=>t.id===e.id);t&&(v({connector:t}),O(e),M(!0))}}(0,n.useEffect)(()=>{var e,t;N?et(2):f&&!es?(et(3),M(!1)):q&&(D||j&&(null===(e=j.cause)||void 0===e?void 0:e.code)==4001)?(et(4),M(!1)):B&&!(j&&(null===(t=j.cause)||void 0===t?void 0:t.code)==4001)?et(1):H?et(6):et(1)},[N,f,D,j,B,es]),(0,n.useEffect)(()=>{let e;return f&&!es&&(e=setTimeout(()=>{ea(!0)},2e3)),()=>clearTimeout(e)},[f,es]),(0,n.useEffect)(()=>{es&&et(5)},[es]),(0,n.useEffect)(()=>{var e;U(!!j&&(null===(e=j.cause)||void 0===e?void 0:e.code)!==4001)},[j]);let[en,el]=(0,n.useState)("");(0,n.useEffect)(()=>{W&&Q(W.id.toString())},[W]);let[eo,er]=(0,n.useState)(null),[ec,ed]=(0,n.useState)(null),[eh,em]=(0,n.useState)(null),[ep,eu]=(0,n.useState)(null),[ex,ef]=(0,n.useState)(!1),{write:eg,data:ev,isSuccess:ey}=(0,i.GG)({address:eo,abi:ec,functionName:"transfer",args:[eh,ep]}),{sendTransaction:ej,isLoading:eN,error:ew,data:eb,isSuccess:ek}=(0,i.pQ)();(0,n.useEffect)(()=>{ex&&(eg(),ef(!1))},[ex]);let eC=(e=null==W?void 0:W.id,null==H||H.networks.find(t=>t.id===e),null==H?void 0:H.networks.find(t=>t.id===e)),{data:eS,error:eP}=(0,i.do)({address:null==eC?void 0:eC.contract_address,abi:null==eC?void 0:eC.contract_ABI,functionName:"balanceOf",args:[g]});if(void 0!==eS){let e=null==eC?void 0:eC.decimal_place,s=BigInt(eS);t=Number(s)/10**e}return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"interface-wrapper",children:(0,a.jsxs)("div",{id:"interface-container",className:"interface-container",children:[(0,a.jsxs)("div",{className:"left-section",children:[ee>1&&(0,a.jsx)("span",{className:"material-symbols-outlined",onClick:()=>{console.log("Quiero volver atr\xe1s"),console.log(ee),4==ee&&et(1),5==ee&&(b(),ea(!1),F(null),O(null),et(1),M(!1)),6==ee&&(et(5),R(null)),7==ee&&et(6)},children:"arrow_back"}),7==ee&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{className:"interface-title",children:"Consejo"}),(0,a.jsx)("p",{className:"texto-ayuda",children:"Pulse realizar el pago en otra red distinta a la seleccionada, revise el precio por transacci\xf3n para evitar pagar m\xe1s de la cuenta."})]}),6==ee&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{className:"interface-title",children:"Env\xede sus datos"}),(0,a.jsx)("p",{className:"texto-ayuda",children:"Necesitamos la siguiente informaci\xf3n para poder ponernos en contacto en caso de que haya alg\xfan problema."})]}),5==ee&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{className:"interface-title",children:"Seleccione una criptomoneda"}),(0,a.jsx)("p",{className:"texto-ayuda",children:"Pulse sobre la criptomoneda con la que desee efectuar el pago, posteriormente puede elegir la red con la que realizarlo."})]}),ee<5&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{className:"interface-title",children:"Conecta tu billetera"}),(0,a.jsx)("p",{className:"texto-ayuda",children:"Pulse sobre la billetera para conectarse y realizar el pago."}),(0,a.jsx)(o,{currentStep:ee})," "]}),f&&ee>4&&(0,a.jsxs)(a.Fragment,{children:[console.log(Y),(0,a.jsxs)("div",{className:"exchange-info-left",children:[(0,a.jsx)("div",{className:"exchange-logo-container",children:(0,a.jsx)("img",{className:"imagen-logo",src:"/pasarela/"+function(e){for(let t=0;t<m.length;t++)if(m[t].id===e.id)return m[t].logoImg;return""}(_),alt:""})}),(0,a.jsxs)("div",{className:"info-wallet-left",children:[(0,a.jsx)("span",{className:"address-wallet",children:function(e){let t=e.slice(0,4),s=e.slice(-4);return t+"..."+s}(g)}),(0,a.jsxs)("span",{className:"balance-wallet",children:[parseFloat(null==Y?void 0:Y.formatted).toFixed(4)," ",null==Y?void 0:Y.symbol]})]}),(0,a.jsx)("span",{className:"material-symbols-outlined",onClick:()=>{b(),ea(!1),F(null),O(null),et(1),M(!1),R(null)},children:"logout"})]})]}),A&&(0,a.jsxs)("div",{className:"exchange-info-left",children:[(0,a.jsx)("div",{className:"exchange-logo-container",children:(0,a.jsx)("img",{className:"imagen-logo",src:"/pasarela/"+function(e){for(let t=0;t<c.length;t++)if(c[t].id===e.id)return c[t].logoImg;return""}(A),alt:""})}),(0,a.jsx)("span",{className:"exchange-name",children:null==A?void 0:A.nameExchange})]})]}),(0,a.jsxs)("div",{className:"right-section",children:[function(){switch(ee){case 1:return(0,a.jsx)(T,{wallets:I,exchanges:c,onClick:ei,error:B,billeteras:m});case 2:case 3:case 4:return(0,a.jsx)(l,{onClick:()=>ei(_),currentStep:ee,connectedObject:_,inicioStep:()=>void et(1),billeteras:m})}}(),5==ee&&(0,a.jsx)(d,{cryptos:s,onClick:function(e){R(e),et(6)},walletExchange:_||A}),6==ee&&(0,a.jsx)(x,{onClick:(e,t)=>{el(e)},enviarStep:()=>{et(7)}}),7==ee&&(0,a.jsx)(k,{cryptos:s,walletExchange:_,selectedCrypto:H,selectedNetwork:G,handleNetworkChange:e=>{Q(e),X&&X(parseInt(e,10))},chains:Z,isLoading:N,pendingChainId:K,cryptoNetworks:z,switchNetwork:X,data:Y,isError:$,balances:t,isloadingnetwork:J,onClick:function(e){console.log("aqui hago el pago");let t=null==H?void 0:H.networks.find(e=>e.id===Number(G)),s=null==t?void 0:t.contract_pay;console.log(e);let a=function(){let e=null==H?void 0:H.networks.find(e=>e.id===Number(G));return!!e&&!!e.contract_address}();try{a?(console.log("Es token "),function(e){console.log(G);let t=null==H?void 0:H.networks.find(e=>e.id===Number(G)),s=null==t?void 0:t.contract_pay;console.log("Direcci\xf3n del contrato en ".concat(null==t?void 0:t.name,": ").concat(s," de ").concat(null==H?void 0:H.name)),er(null==t?void 0:t.contract_address),ed(null==t?void 0:t.contract_ABI),em(null==t?void 0:t.contract_pay),e.toString(),eu(function(e){if(isNaN(e=Number(e)))throw Error("Input must be a number");let t=e.toFixed(6).split(".");return t[0]+t[1]}(e)),console.log(ep),console.log("Contract address: ",eo),ef(!0)}(e)):(console.log("Es Coin"),function(e,t,s){try{ej({to:e,value:(0,C.fiT)(s)})}catch(e){console.error(e)}}(s,0,e))}catch(e){console.error(e)}},isSuccessCoin:ek,isSuccessToken:ey,dataHashCoin:eb,dataHashToken:ev,email:en,address:g,onTryAgain:()=>{b(),ea(!1),F(null),O(null),et(1),M(!1),R(null);let e=document.getElementById("interface-container");null==e||e.classList.remove("menu-open4"),null==e||e.classList.remove("menu-open7")}})]})]})})})}()})}},46601:function(){},89214:function(){},85568:function(){},52361:function(){},94616:function(){}},function(e){e.O(0,[714,764,955,490,774,888,179],function(){return e(e.s=48312)}),_N_E=e.O()}]);